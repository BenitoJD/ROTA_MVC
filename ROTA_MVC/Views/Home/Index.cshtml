@using System.Security.Claims

@{
    ViewData["Title"] = ViewData["PageTitle"] ?? "Home";
    var userGreeting = ViewData["UserGreeting"] as string;
    bool isAuthenticated = User.Identity?.IsAuthenticated ?? false;
    bool isAdmin = User.IsInRole("Admin");
}

<style>
    /* Minor style adjustments if needed */
    .feature-card {
        border: 1px solid var(--md-sys-color-outline); /* Add subtle outline matching theme */
    }

    .card-icon {
        font-size: 2.5rem; /* Larger icons */
        margin-bottom: 1rem;
        color: var(--md-sys-color-primary); /* Use theme color */
    }

    .icon-link > .bi-arrow-right { /* Style the icon link */
        transition: transform .2s ease-in-out;
    }

    .icon-link:hover > .bi-arrow-right {
        transform: translateX(4px);
    }

</style>

@* --- Top Section / Welcome --- *@
<div class="container px-4 py-5 text-center">
    @* Optional: Simple Logo/Icon *@
    @* <i class="bi bi-calendar3" style="font-size: 3rem; color: var(--md-sys-color-primary);"></i> *@

    @if (!string.IsNullOrEmpty(userGreeting))
    {
        <h1 class="display-5 fw-normal text-body-emphasis">@userGreeting</h1> @* Use standard display class *@
        <p class="fs-5 text-body-secondary mt-2">Welcome back to the ROTA management system.</p>
    }
    else
    {
        <h1 class="display-5 fw-normal text-body-emphasis">Rota Management System</h1>
        <p class="fs-5 text-body-secondary mt-2">Efficiently manage schedules, leave, and team coordination.</p>
    }

    @* Call to Action Buttons *@
    <div class="d-grid gap-2 d-sm-flex justify-content-sm-center mt-4 pt-3">
        @if (isAuthenticated)
        {
            <a class="btn btn-primary btn-lg px-4 gap-3" asp-controller="Dashboard" asp-action="Index"><i class="bi bi-speedometer2 me-2"></i>Dashboard</a>
            <a class="btn btn-secondary btn-lg px-4" asp-controller="Shifts" asp-action="Calendar"><i class="bi bi-calendar-week me-2"></i>View Calendar</a>
        }
        else
        {
            <a class="btn btn-primary btn-lg px-4 gap-3" asp-controller="Auth" asp-action="Login"><i class="bi bi-box-arrow-in-right me-2"></i>Login</a>
        }
    </div>
</div>

@* --- Feature Highlight Section --- *@
<div class="container px-4 py-4" id="feature-section">
    <h2 class="pb-2 text-center mb-5">Key Features</h2>
    <div class="row g-4 py-3 row-cols-1 row-cols-md-2 row-cols-lg-3">
        @* Added md breakpoint *@

        @* Feature 1: Calendar View *@
        <div class="feature col">
            <div class="card h-100 text-center shadow-sm feature-card">
                @* Keep card structure *@
                <div class="card-body d-flex flex-column">
                    <div class="card-icon"><i class="bi bi-calendar-check"></i></div>
                    <h3 class="fs-4 fw-semibold">Visual Calendar</h3>
                    <p class="card-text text-body-secondary">Easily view shifts and leave across monthly, weekly, or daily layouts. See who's on call at a glance.</p>
                    <div class="mt-auto">
                        @* Push link down *@
                        @if (isAuthenticated)
                        {
                            <a asp-controller="Shifts" asp-action="Calendar" class="icon-link fw-medium">View Calendar <i class="bi bi-arrow-right"></i></a>
                        }
                        else
                        {
                            <span class="text-muted">(Login required)</span>
                        }
                    </div>
                </div>
            </div>
        </div>

        @* Feature 2: Leave Management *@
        <div class="feature col">
            <div class="card h-100 text-center shadow-sm feature-card">
                <div class="card-body d-flex flex-column">
                    <div class="card-icon text-success"><i class="bi bi-calendar-x"></i></div> @* Keep color variation *@
                    <h3 class="fs-4 fw-semibold">Leave Requests</h3>
                    <p class="card-text text-body-secondary">Submit time-off requests easily. Administrators can review, approve, or reject requests efficiently.</p>
                    <div class="mt-auto">
                        @if (isAuthenticated)
                        {
                            <a asp-controller="LeaveRequests" asp-action="Index" class="icon-link fw-medium">Manage Leave <i class="bi bi-arrow-right"></i></a>
                        }
                        else
                        {
                            <span class="text-muted">(Login required)</span>
                        }
                    </div>
                </div>
            </div>
        </div>

        @* Feature 3: Admin Control *@
        <div class="feature col">
            <div class="card h-100 text-center shadow-sm feature-card">
                <div class="card-body d-flex flex-column">
                    <div class="card-icon text-warning"><i class="bi bi-sliders"></i></div> @* Keep color variation *@
                    <h3 class="fs-4 fw-semibold">Admin Dashboard</h3>
                    <p class="card-text text-body-secondary">Get summaries of pending requests, team availability, shift distributions, and manage all system settings.</p>
                    <div class="mt-auto">
                        @if (isAdmin)
                        {
                            <a asp-controller="Dashboard" asp-action="Index" class="icon-link fw-medium">Go to Dashboard <i class="bi bi-arrow-right"></i></a>
                        }
                        else
                        {
                            <span class="text-muted">(Admin Access Required)</span>
                        }
                    </div>
                </div>
            </div>
        </div>

    </div> @* End row *@
</div> @* End feature-section container *@