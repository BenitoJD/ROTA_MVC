@model ROTA_MVC.Models.UserDetailDto

@{
    ViewData["Title"] = "User Account Details";
    var userId = Model.UserId; 
}

@* --- Page Header --- *@
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2">@ViewData["Title"]</h1>
     <div> @* Action Buttons Area *@
         <a asp-action="Index" class="btn btn-sm btn-outline-secondary">
             <i class="bi bi-arrow-left me-1"></i> Back to Users List
         </a>
         <a asp-action="EditRole" asp-route-userId="@userId" class="btn btn-sm btn-secondary ms-2">
             <i class="bi bi-person-badge me-1"></i>Change Role
         </a>
          <a asp-action="EditStatus" asp-route-userId="@userId" class="btn btn-sm btn-warning ms-1">
              <i class="bi bi-lightbulb-@(Model.IsActive ? "off" : "fill") me-1"></i>Change Status
          </a>
         @* Optional Delete User button - use with extreme caution *@
          @* <a asp-action="Delete" asp-route-userId="@userId" class="btn btn-sm btn-outline-danger ms-1"><i class="bi bi-trash3 me-1"></i>Delete...</a> *@
    </div>
</div>

<div class="row justify-content-center">
    <div class="col-lg-10 col-xl-8">
        <div class="card shadow-sm mb-4">
             <div class="card-header d-flex justify-content-between align-items-center flex-wrap">
                 <h4 class="mb-0 me-3">
                    <i class="bi bi-person-vcard me-2 text-primary"></i> @* User Icon *@
                    @Model.Username
                 </h4>
                  @* Status Badge in Header *@
                 @if(Model.IsActive) { <span class="badge rounded-pill bg-success-subtle text-success-emphasis fs-6 px-3 py-1"><i class="bi bi-check-circle-fill me-1"></i>Active</span> }
                 else { <span class="badge rounded-pill bg-danger-subtle text-danger-emphasis fs-6 px-3 py-1"><i class="bi bi-slash-circle-fill me-1"></i>Inactive</span> }
             </div>
            <div class="card-body p-4">

                 @* Section 1: Account Details *@
                 <div class="mb-4 pb-3 border-bottom">
                     <h5 class="text-primary-emphasis mb-3 small text-uppercase fw-semibold">Account Details</h5>
                    <dl class="row mb-0">
                        <dt class="col-sm-4 col-md-3">Username</dt>
                        <dd class="col-sm-8 col-md-9">@Model.Username</dd>

                        <dt class="col-sm-4 col-md-3">Role</dt>
                        <dd class="col-sm-8 col-md-9">@Model.RoleName</dd>

                        <dt class="col-sm-4 col-md-3">Last Login</dt>
                         <dd class="col-sm-8 col-md-9">@(Model.LastLogin.HasValue ? Model.LastLogin.Value.ToLocalTime().ToString("f") : Html.Raw("<span class='text-muted'>Never</span>"))</dd> @* Use 'f' for clearer date/time *@

                        <dt class="col-sm-4 col-md-3">Account Created</dt>
                        <dd class="col-sm-8 col-md-9">@Model.CreatedAt.ToLocalTime().ToString("f")</dd>

                        <dt class="col-sm-4 col-md-3">Last Updated</dt>
                        <dd class="col-sm-8 col-md-9">@Model.UpdatedAt.ToLocalTime().ToString("f")</dd>
                    </dl>
                 </div>

                 @* Section 2: Linked Employee *@
                 <div class="mb-3">
                     <h5 class="text-primary-emphasis mb-3 small text-uppercase fw-semibold">Linked Employee</h5>
                     @if(string.IsNullOrWhiteSpace(Model.EmployeeFullName)) {
                          <p class="text-danger"><i class="bi bi-exclamation-triangle me-1"></i> No employee linked to this user account!</p>
                     } else {
                         <dl class="row mb-0">
                            <dt class="col-sm-4 col-md-3">Full Name</dt>
                            <dd class="col-sm-8 col-md-9">
                                @* Link to Employee Details page *@
                                <a asp-controller="Employees" asp-action="Details" asp-route-id="@Model.EmployeeId">@Model.EmployeeFullName</a>
                            </dd>

                            <dt class="col-sm-4 col-md-3">Employee ID</dt>
                            <dd class="col-sm-8 col-md-9 text-muted small">@Model.EmployeeId</dd>
                        </dl>
                     }
                 </div>

            </div> @* End Card Body *@
            <div class="card-footer bg-light text-muted small">
                 User ID: @Model.UserId
             </div>
        </div> @* End Card *@
    </div> @* End Col *@
</div> @* End Row *@