@model ROTA_MVC.Models.UserDetailDto 
@using System.Security.Claims 

@{
    ViewData["Title"] = "My Profile";
}

@* --- Page Header --- *@
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2">@ViewData["Title"]</h1>
    @* Actions can go here or in the card below *@
    <div class="btn-toolbar mb-2 mb-md-0">
         <a asp-action="ChangePassword" class="btn btn-sm btn-outline-primary">
            <i class="bi bi-key-fill me-1"></i>Change Password
         </a>
         @* Optional Edit Profile Button
         <a asp-action="EditProfile" class="btn btn-sm btn-outline-secondary ms-2">
             <i class="bi bi-pencil me-1"></i>Edit Details
         </a>
          *@
    </div>
</div>

@* Display Feedback Messages *@
@if (TempData["ErrorMessage"] != null) { <div class="alert alert-danger alert-dismissible fade show mb-4" role="alert">@TempData["ErrorMessage"]<button type="button" class="btn-close" data-bs-dismiss="alert"></button></div> }


<div class="row justify-content-center">
    <div class="col-lg-10 col-xl-8"> @* Wider layout for details *@
        <div class="card shadow-sm mb-4">
            <div class="card-header d-flex align-items-center">
                <i class="bi bi-person-circle fs-3 me-3 text-primary"></i> @* Icon in header *@
                <h4 class="mb-0">Account & Profile Information</h4>
            </div>
            <div class="card-body p-4">

                 @* Section 1: User Account Details *@
                 <div class="mb-4 pb-3 border-bottom">
                     <h5 class="text-primary-emphasis mb-3 small text-uppercase fw-semibold">Login Details</h5>
                    <dl class="row mb-0">
                        <dt class="col-sm-4 col-md-3">Username</dt>
                        <dd class="col-sm-8 col-md-9">@Model.Username</dd>

                        <dt class="col-sm-4 col-md-3">Role</dt>
                        <dd class="col-sm-8 col-md-9">@Model.RoleName</dd>

                        <dt class="col-sm-4 col-md-3">Account Status</dt>
                        <dd class="col-sm-8 col-md-9">
                             @if(Model.IsActive) { <span class="badge bg-success-subtle text-success-emphasis rounded-pill">Active</span> }
                             else { <span class="badge bg-danger-subtle text-danger-emphasis rounded-pill">Inactive</span> }
                        </dd>

                         <dt class="col-sm-4 col-md-3">Last Login</dt>
                         <dd class="col-sm-8 col-md-9">@(Model.LastLogin.HasValue ? Model.LastLogin.Value.ToLocalTime().ToString("f") : Html.Raw("<span class='text-muted'>Never</span>"))</dd>

                        <dt class="col-sm-4 col-md-3">User ID</dt>
                        <dd class="col-sm-8 col-md-9 text-muted small">@Model.UserId</dd>
                    </dl>
                 </div>

                 @* Section 2: Linked Employee Details *@
                 <div class="mb-3">
                     <h5 class="text-primary-emphasis mb-3 small text-uppercase fw-semibold">Employee Details</h5>
                     <dl class="row mb-0">
                        <dt class="col-sm-4 col-md-3">Full Name</dt>
                        <dd class="col-sm-8 col-md-9">@Model.EmployeeFullName</dd>

                        @* Assuming EmployeeDto linked here has these - adjust if not *@
                        @* <dt class="col-sm-4 col-md-3">Email</dt>
                        <dd class="col-sm-8 col-md-9">@(string.IsNullOrEmpty(Model.Email) ? "N/A" : Model.Email)</dd>

                        <dt class="col-sm-4 col-md-3">Phone</dt>
                        <dd class="col-sm-8 col-md-9">@(string.IsNullOrEmpty(Model.PhoneNumber) ? "N/A" : Model.PhoneNumber)</dd>

                         <dt class="col-sm-4 col-md-3">Team</dt>
                         <dd class="col-sm-8 col-md-9">@(string.IsNullOrEmpty(Model.TeamName) ? "Unassigned" : Model.TeamName)</dd> *@

                         <dt class="col-sm-4 col-md-3">Linked Employee ID</dt>
                        <dd class="col-sm-8 col-md-9 text-muted small">@Model.EmployeeId</dd>
                    </dl>
                 </div>

            </div> @* End Card Body *@
            @* Optional Footer for other system info *@
            <div class="card-footer bg-light text-muted small">
                Account Created: @Model.CreatedAt.ToLocalTime().ToString("D")
            </div>
        </div> @* End Card *@
    </div> @* End Col *@
</div> @* End Row *@